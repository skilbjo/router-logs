#!/bin/bash
set -eou pipefail

cmd="src/monitor"

# Prereqs -- qemu doesn't do shell redirection
echo "firewall.,192.168.1.1 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAwDBSze6Ek0EOwUABRIEmt51rkBFdajJxzqIU4PksSk/Xuv+z4lFHV74ptGk6EtYosdak4kj7US4Gr/UBx54atzS3C7bNdruw3p2njgo+qZDJ+PJBHySCw+LyF8pxi9y/bIeQSCrTf/MHffbqkqaTAd+sI8h2aasIznTI0O+bocEdXvewhLfLZqQ2zy5mTMbpzA3Sz1LjTBiKkW7Sh/THXmMlGAGqv0dAhm3HPzT7Ps6JX7AQ0/rGrppNGlhAJqJoZpiW46WGGvhE9oWQ1ZtzyBCNo+pZd7f+VKhE2S2zZNS1zRqC0POQ6UgErwR3HTMEjVRkiaglkljB9SVMKoWRv/OLPU=" >> ~/.ssh/known_hosts && \
  echo "router.,192.168.2.1 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzAqkE7apyj0WBrzrNavg/4UXEHA7kEpY7Z15dA2NsZJs63peC5DARmJ2yFcR0FxzG/kFOi7CpLUv9bmdi2Nl+KCNStMsEiHUt75iwA6jtkTYa4/WjDmpQiAg0EVBGNv3uPa/NEAdQAPzuUoRXt+6j7qOv/+RqOZSJ2ZJmlGqyfQ4IXGqYLWE7OWOxHlx8MySPG99R8wNw0dlcLQnI42eBQueQirr9wwPKhwvCJNhf1WyVndJYjDYEgLbXctu400Z/L9fnkao7vF3mG3lo4TiDMtZtyiUH6ITnCy5h/Eqo9/jnQ4yFlHCNTpA27ob+WA3GD+f/joTh/iqnrRlt7j6D" >> ~/.ssh/known_hosts && \
  echo "pfsense.,192.168.0.1 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOe6Rd5ZChJFz3uxLLrBH4bU8ZCcWgbbOXMPRkP+lXlu" >> ~/.ssh/known_hosts && \
  echo "$id_rsa" >> ~/.ssh/id_rsa

exec $cmd $@
